<HTML>
<HEAD>   
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">   
    <META NAME="Author" CONTENT="Tom Archer">
    <TITLE>Internet - Table of Contents</TITLE>   
    <META Name="description" Content="Source codes for internet">
    <META Name="keywords" Content="SOURCE CODE INTERNET">

    <SCRIPT LANGUAGE="JavaScript">
<!--
var axel = Math.random() + "";
var ord = axel * 1000000000000000000 + "?";

//This part of script alleviates a Netscape document.write bug
<!-- 
NS4 = document.layers;
if (NS4) {
origWidth = innerWidth;
origHeight = innerHeight;
}
function reDo() {
if (innerWidth != origWidth || innerHeight != origHeight) 
location.reload();
}
if (NS4) onresize = reDo;
//-->
</SCRIPT>

</HEAD>



<body>

<!-- begin logo and top banner ad table -->

<TABLE width=100% cellpadding="0" cellspacing="0">

  <TR align="left">
    <TD COLSPAN="3" VALIGN="TOP" align="left">
      <A HREF="http://www.earthweb.com" TARGET="_top">
        <IMG SRC="/images/eweb_banner.gif" BORDER="0" ALT="EarthWeb">
      </a>
    </TD>
  </TR>

  <TR>
<!--BljAds
    <TD VALIGN="TOP" align=left>
      <A HREF="/">
        <IMG SRC="/images/logo_cobrand.gif" BORDER="0" ALT="Developer.com">
      </a>
    </TD>

    <TD>
      <img src="/images/dotclear.gif" WIDTH="40" HEIGHT="1">
    </TD>
-->
    <TD align="TOP">
    <center>
      <A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/9317/468x60-1/House_Enterprise_Wireless_1d/ewf2002-468.gif/31386135353132373363616432346330" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_Enterprise_Wireless_1d/ewf2002-468.gif"  WIDTH=468 HEIGHT=60 ALT="Where Wireless Technology & Business Intersect"  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/9317/468x60-1/House_Enterprise_Wireless_1d/ewf2002-468.gif/31386135353132373363616432346330?_RM_EMPTY_" Width="1" Height="1" Border="0">
<!-- Counter Position Eliminated -->

    </center>
    </TD>
  </TR>

</TABLE>
<hr>
<!-- end logo and top banner ad table -->

<!-- begin lower outer table -->

<TABLE cellpadding="0" cellspacing="0" border="0">
<TR>
<TD bgcolor=#efefef VALIGN="TOP" WIDTH="90">




<table border=1 cellspacing=0 cellpadding=0>
<tr><td>

<table border=0 cellpadding=5 cellspacing=0 width=150>
   <tr>
     <td align="center">
      <A HREF="/">
        <IMG SRC="/images/logo_cobrand.gif" BORDER="0" ALT="Developer.com">
      </a>
      </td>
   </tr>
   <tr>
     <td align="center">
     <A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/28075/125x125-1/House_125/cyberatlasnew_125.gif/31386135353132373363616432346330" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_125/cyberatlasnew_125.gif"  WIDTH=125 HEIGHT=125 ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/28075/125x125-1/House_125/cyberatlasnew_125.gif/31386135353132373363616432346330?_RM_EMPTY_" Width="1" Height="1" Border="0">
     </td>
   </tr>
</table>

</td></tr>
<tr><td>
  <table width=130 border=0 cellpadding=5 cellspacing=0>
    <tr>
      <td>
        <!-- SEARCH FORM-->
        <form method="post" action="http://search.internet.com/codeguru.earthweb.com">
          <input type="hidden" name="IC_StartNumber" value="0">
          <input type="hidden" name="IC_BatchSize" value="10">
          <input type="hidden" name="IC_RelevanceThreshold" value="30">
          <input type="hidden" name="IC_QueryDatabase"  value="codeguru.earthweb.com">
          <input type="text"   name="IC_QueryText" value="" size="10">
          <input type="submit" value="Search">
        </form>
        <!-- END OF SEARCH FORM -->
    		<!--<IMG src="http://codeguru.developer.com/images/rule.gif" width="105" vspace=3 height="2" ALT="-----">-->
      </td>
    </tr>
  </table>

  <table border=0 cellpadding=5 cellspacing=0 width=150>
    <tr><td><span class="navBarH1">CodeGuru Sites</span></td></tr>
    <tr><td nowrap>
        <small>
          <a href="/index.shtml">Visual C++/MFC</a><br>
          <a HREF="/csharp/index.shtml">.NET (C# and more)</a><br>
          <a href="/vb/index.shtml">Visual Basic</a><br>
          <hr>
        </small>
    </td></tr>

    <tr><td nowrap>
        <small>
          <a href="/cgi-bin/bbs/wt/wwwthreads.pl">Discussion Boards</a><br>
          <a href="/announcements/dotnetbooks.html">Books on .NET</a><img src="/images/new.gif"><br>
          <a HREF="/bookReviews/index.shtml">Book Reviews</a><br>
          <a href="http://e-newsletters.internet.com">Newsletters (subscribe)</a><br>
          <a href="/newsletters/index.shtml">Newsletters (archived)</a><br> 
          <hr>
        </small>
    </td></tr>

    <tr><td><span class="navBarH1">Article Sections</span></td></tr>

    <tr><td>
      <span class="navBarH2">C++</span>
      <br>
      <small>
        <a href="/algorithms/index.shtml">algorithms & formulas</a></br>
        <a href="/cpp_mfc/index.shtml">c++ & mfc</a><br>
        <a href="/date_time/index.shtml">date & time</a><br>
        <a href="/string/index.shtml">string</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">COM-based Technologies</span>
      <br>
      <small>
        <a href="/atl/index.shtml">atl & wtl</a><br>
        <a href="/activex/index.shtml">com & activex</a><br>
        <a href="/complus/index.shtml">com+</a><br>
        <a href="/shell/index.shtml">shell programming</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Controls</span>
      <br>
      <small>
        <a href="/buttonctrl/index.shtml">button control  </a><br>
        <a href="/combobox//index.shtml">combobox  </a><br>
        <a href="/editctrl/index.shtml">edit control  </a><br>
        <a href="/imagelist/index.shtml">imagelist control </a><br>
        <a href="/listbox/index.shtml">listbox control  </a><br>
        <a href="/listview/index.shtml">listview control  </a><br>
        <a href="/menu/index.shtml">menu  </a><br>
        <a href="/controls/index.shtml">other controls </a><br>
        <a href="/propertysheet/index.shtml">property sheet  </a><br>
        <a href="/richedit/index.shtml">rich edit control  </a><br>
        <a href="/staticctrl/index.shtml">static control  </a><br>
        <a href="/statusbar/index.shtml">status bar </a><br>
        <a href="/toolbar/index.shtml">toolbar  </a><br>
        <a href="/treeview/index.shtml">treeview control </a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Data</span>
      <br>
      <small>
    <!--
        <a href="/ado/index.shtml">ado & oledb</a><br>
        <a href="/odbc/index.shtml">odbc</a><br>
        <a href="/mfc_database/index.shtml">mfc database classes</a><br>
        <a href="/office_db/index.shtml">office products</a><br>
        <a href="/oracle/index.shtml">oracle</a><br>
        <a href="/serialization/index.shtml">serialization</a><br>
        <a href="/sqlserver/index.shtml">sql server</a><br>
    -->
        <a href="/mfc_database/index.shtml">database</a><br>
        <a href="/data-misc/index.shtml">miscellaneous</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Frameworks</span>
      <br>
      <small>
    <!--
        <a href="/component_frameworks/index.shtml">component frameworks</a><br>
        <a href="/printing_frameworks/index.shtml">printing frameworks</a><br>
        <a href="/ui_frameworks/index.shtml">ui frameworks</a><br>
    -->
        <a href="/advancedui/index.shtml">ui & printing frameworks</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Graphics & Multimedia</span>
      <br>
      <small>
        <a href="/bitmap/index.shtml">bitmaps & palettes</a><br>
        <a href="/directx/index.shtml">directx</a><br>
        <a href="/gdi/index.shtml">gdi</a><br>
        <a href="/multimedia/index.shtml">multimedia</a><br>
        <a href="/opengl/index.shtml">opengl</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Internet & Networking</span>
      <br>
      <small>
        <a href="/ieprogram/index.shtml">ie programming</a><br>
        <a href="/internet/index.shtml">internet protocols</a><br>
        <a href="/isapi/index.shtml">isapi</a><br>
        <a href="/network/index.shtml">network protocols</a><br>
      </small>
    </td></tr>
	
    <tr><td>
      <span class="navBarH2">Miscellaneous</span>
      <br>
      <small>
        <a href="/misc/index.shtml">miscellaneous</a><br>
      </small>
    </td></tr>

    <!--
    <tr><td><span class="navBarH2">Security</span></td></tr>
    <tr><td><small>
      <a href="/cryptoapi/index.shtml">crypto api</a><br>
      <a href="/encryption/index.shtml">encryption/decryption</a><br>
      <br>
    </small></td></tr>
    -->

    <tr><td>
      <span class="navBarH2">Visual Studio</span>
      <br>
      <small>
    <!--
        <a href="/addins/index.shtml">add-ins</a><br>

        <a href="/tips/index.shtml">editor tips</a><br>
        <a href="/macros/index.shtml">macros</a><br>
    -->
        <a href="/debug/index.shtml">debugging</a><br>
        <a href="/devstudio_macros/index.shtml">add-ins & macros</a><br>
        <a href="/tips/index.shtml">editor tips</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Windows Programming</span>
      <br>
      <small>
        <a href="/ce/index.shtml">ce</a><br>
        <a href="/clipboard/index.shtml">clipboard</a><br>
        <a href="/dll/index.shtml">dll</a><br>
        <a href="/files/index.shtml">file & folder</a><br>
        <a href="/help/index.shtml">help systems</a><br>
        <a href="/printing/index.shtml">printing</a><br>
        <a href="/win32/index.shtml">win32</a><br>
        <a href="/system/index.shtml">system</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Windows & Dialogs</span>
      <br>
      <small>
        <a href="/console/index.shtml">console</a></br>
        <a href="/dialog/index.shtml">dialog</a><br>
        <a href="/docking/index.shtml">docking window</a><br>
        <a href="/doc_view/index.shtml">doc/view</a><br>
        <a href="/splitter/index.shtml">splitter</a><br>
      </small>
    </td></tr>

    <tr><td><span class="navBarH1">Interact</span></td></tr>
    <tr><td><small>
      <a href="http://e-newsletters.internet.com">Newsletters</a><br>
      <a href="/Guestbook/guestbook.shtml">Guestbook</a><br>
      <a href="/cgi-bin/recommend.cgi">Recommend Us!</a><br>
      <a href="/about.shtml">About Us</a><br>
      <br>
    </small></td></tr>

    </table>

<!-- JOB BUTTON --> 
    <table border=0 cellpadding=5 cellspacing=0 width=150>
    <tr><td align="center">
       <a href="http://jobs.internet.com" target="new">
         <IMG SRC="http://www.codeguru.com/jobs.gif" alt="[Internet Jobs]">
       </a>
    </td></tr>
    </table>

  </td>
</tr>
</table>

<!--/navbar>


<!-- blank column for spacing -->

<td valign="top" width="20">&nbsp;&nbsp;&nbsp;</td>

<!-- end blank column for spacing -->

<!-- begin content column -->

<TD VALIGN="TOP" >

<!--
<table cellpadding="0" cellspacing="0">
<tr>
-->

<!-- begin main content column -->


<!-- closign of column, row, and table are in subfoot file -->




<script type="text/javascript" language="javascript"> 
if (screen.width==640 || screen.width==800)
{
   document.write("<link rel=stylesheet href='/global/global800.css'>"); 
} 
else 
{ 
   document.write("<link rel=stylesheet href='/global/global.css'>"); 
} 
</script>


<CENTER><H3><FONT COLOR="#AOAO99">
ATL SMTP Classes
</FONT></H3></CENTER><HR>

This article was contributed by 
<A HREF="mailto:robert@blackcastlesoft.com">Robert Simpson</A>.

<p>
<u>Environment:</u> Visual C++ 6.0, ATL 3.0, runs in Win9X/NT/2K

<h3>Overview</h3>
This is yet another set of lightweight, yet full-featured non-MFC SMTP
classes to enable C++ programs to send outgoing mail.

<h3>Features</h3>
<ul>
  <li>Optional SMTP authentication (username/password)</li>
  <li>Supports multiple recipients using CC and BCC fields</li>
  <li>Supports multipart mixed, related and alternative MIME types</li>
  <li>Supports any number of file attachments and alternative message bodies</li>
  <li>Transfer-encoding using 7bit, 8bit, quoted-printable and base64.</li>
  <li>Can optionally determine the transfer encoding based on content.</li>
  <li>Looks up content-type from the registry.  When not found, it uses application/octet-stream type.</li>
  <li>CSmtp is overridable and has several event mechanisms to notify the parent of progress during transactions with the server.
  </li>
  <li>UNICODE supported.
  </li>
</ul>

<p>The source code is heavily documented, so I will concentrate on the basics of
implementing SMTP support in your applications.</p>

<h3>Setup</h3>
Setup is pretty straightforward.&nbsp; Just insert the <span class="codeFileName">smtp.cpp</span>, 
<span class="codeFileName">base64.cpp</span>,
<span class="codeFileName">smtp.h</span> and <span class="codeFileName">base64.h</span> files 
into a new ATL project or into your
existing ATL project. A very simplistic .cpp file to implement SMTP would
look like this:

<pre>
#include &quot;stdafx.h&quot;
#include &quot;resource.h&quot;
#include &quot;smtp.h&quot;

<span class="codeComment">// ... preamble excluded for clarity</pre></span>
<pre>
extern &quot;C&quot; int WINAPI _tWinMain(HINSTANCE hInstance, 
                                HINSTANCE <span class="codeComment">/* hPrevInstance */</span>, 
                                LPTSTR lpCmdLine, 
                                int <span class="codeComment">/* nShowCmd */</span>)
{  
 CSmtp mail;
 CSmtpMessage msg;
 CSmtpAddress cc;
 CSmtpMessageBody body;
 CSmtpAttachment attach;

 <span class="codeComment">// Initialize winsock  </span>
 WSADATA wsa;
 WSAStartup(MAKEWORD(2,0),&amp;wsa);

 msg.Subject = _T(&quot;Testing&quot;);

 <span class="codeComment">// Who the message is from</span>
 msg.Sender.Name = _T(&quot;My Username&quot;);
 msg.Sender.Address = _T(&quot;myaddress@myemail.com&quot;);

 <span class="codeComment">// Primary recipient</span>
 msg.Recipient.Name = _T(&quot;Someone Else&quot;);
 msg.Recipient.Address = _T(&quot;someoneelse@somewhereelse.com&quot;);

 <span class="codeComment">// Uncomment these lines to add a CC address</span>
 <span class="codeComment">//  cc.Name = _T(&quot;A CCd User&quot;);</span>
 <span class="codeComment">//  cc.Address = _T(&quot;ccuser@ccdaddress.com&quot;);</span>
 <span class="codeComment">//  msg.CC.Add(cc);</span>

 <span class="codeComment">// Uncomment these lines to add a BCC address</span>
 <span class="codeComment">//  cc.Name = _T(&quot;Yet Another CC&quot;);</span>
 <span class="codeComment">//  cc.Address = _T(&quot;YACC@somewhere.com&quot;);</span>
 <span class="codeComment">//  msg.BCC.Add(cc);</span>

 <span class="codeComment">// Assign a value to the message body</span>
 body = _T(&quot;This is a test of the CSmtp class and its support classes, \
 CSmtpAddress, CSmtpMessage and CSmtpMessageBody.  The textual portion \
 of this message should be encoded in the \&quot;quoted-printable\&quot; transport \
 encoding scheme, because the lines in the message are more than 76 \
 characters long.\r\n\r\nThe CSmtpMessage class makes a best-guess \
 effort to determine the proper transport encoding to use to ensure the \
 data comes across in the format originally intended.\r\n&quot;);

 <span class="codeComment">// Add the message body to the message</span>
 msg.Message.Add(body);

 <span class="codeComment">// Here is an example of an alternate message body</span>
 <span class="codeComment">//  body = _T(&quot;&lt;html&gt;&lt;body&gt;Hello World...&lt;/body&gt;&lt;/html&gt;&quot;);</span>
 <span class="codeComment">//  body.Encoding = _T(&quot;text/html&quot;);</span>
 <span class="codeComment">//  msg.Message.Add(body);</span>

 <span class="codeComment">// Here are some samples of adding attachments to the message</span>
 <span class="codeComment">//  attach = _T(&quot;d:\\temp\\ntregmon.zip&quot;);</span>
 <span class="codeComment">//  msg.Attachments.Add(attach);</span>
 <span class="codeComment">//</span>
 <span class="codeComment">//  attach = _T(&quot;d:\\src\\smtpapp\\readme.html&quot;);</span>
 <span class="codeComment">//  msg.Attachments.Add(attach);</span>

 <span class="codeComment">// Assign these values only if your SMTP server requires authentication</span>
 mail.m_strUser = _T(&quot;myusername&quot;);
 mail.m_strPass = _T(&quot;mypassword&quot;);

 <span class="codeComment">// Attempt to connect to the mailserver</span>
 if (mail.Connect(_T(&quot;mail.mymailserver.com&quot;)))
 {
  <span class="codeComment">// Send the message and close the connection afterwards</span>
  mail.SendMessage(msg);
  
  <span class="codeComment">// Alternate one-shot method of sending a message</span>
  <span class="codeComment">// mail.SendMessage(_T(&quot;foo@bar.com&quot;),
                      _T(&quot;someone@else.com&quot;),
                      _T(&quot;My Subject&quot;),
                      _T(&quot;This is the msg body&quot;));</span>
  mail.Close();
 }

 WSACleanup();
 
 return 0;
}</pre>

<p>For added control, you can easily implement a class which inherits from the
CSmtp class.&nbsp; By providing your own implementation of <b>SmtpWarning</b>, <b>SmtpError</b>,
<b>SmtpCommandResponse</b> and <b>SmtpProgress</b>, you can provide users with some visual
indication of what is happening.&nbsp; Furthermore, the <b>SmtpWarning</b> event
is raised when authentication fails, either when the connection is first
established, or in response to an outgoing mail request being made.&nbsp; By
overriding this event, you can provide users with a way of supplying credentials
to be resumbitted to the SMTP server.</p>

<p>The CSmtpMessage class also supports the multipart/related MIME type, which
is used most commonly to embed images and other items into an html
message.&nbsp; Here's an example of how to embed an image into a mail message
using multipart/related:</p>
<pre>CSmtpMessage msg;
CSmtpMessageBody body;
CSmtpAttachment  attach;

<span class="codeComment">// The MimeType must be explicitly set for this type of message</span>
msg.MimeType = mimeRelated;

body = _T(&quot;&lt;html&gt;&lt;body&gt;This is an inline image&lt;br&gt; \
&lt;img src=&quot;cid:1234567&quot;&gt;&lt;/body&gt;&lt;/html&gt;&quot;);

body.Encoding = _T(&quot;text/html&quot;);

attach = _T(&quot;c:\\web\\myimage.jpg&quot;);
attach.ContentId = _T(&quot;1234567&quot;);

msg.Message.Add(body);
msg.Attachments.Add(attach);</pre>
<p>I'm not sure about compatibility, but you can also reference the attachment
by name, in which case, the code would be even simpler:</p>
<pre>msg.MimeType = mimeRelated;

body = _T(&quot;&lt;html&gt;&lt;body&gt;This is an inline image&lt;br&gt; \
&lt;img src=&quot;myimage.jpg&quot;&gt;&lt;/body&gt;&lt;/html&gt;&quot;);

body.Encoding = _T(&quot;text/html&quot;);

attach = _T(&quot;c:\\web\\myimage.jpg&quot;);

msg.Message.Add(body);
msg.Attachments.Add(attach);</pre>
<p>I tested this on Outlook 2000 and it worked fine.&nbsp; I'd be curious to
note if this works for other e-mail applications.</p>

<h3>Version History</h3>
<ul>
  <li>Version 1.7 - 06/18/2001
    <ul>
      <li>Modified the code that gets the GMT offset and the code that parses the date/time as per Noa Karsten's suggestions.</li>
      <li>Added an FD_ZERO(&set) to the last part of SendCmd(), since I use the set twice and only zero it out once.  Submitted by Marc Allen.</li>
      <li>Removed the requirement that a message have a body and/or an attachment in order to send it.  This allows you to send a message containing only a header.  Submitted by Marc Allen.</li>
    </ul>
  </li>
  <li>Version 1.6 - 04/04/2001
    <ul>
      <li>Apparently older versions of the STL do not have the clear() method for basic_string's.  I modified the code to use erase() instead.</li>
      <li>Added #include &lt;atlbase.h&gt; to the smtp.h file, which will allow any app
        (even non-ATL apps) to use these classes without problems.</li>
    </ul>
  </li>
  <li>Version 1.5 - 03/30/2001
    <ul>
      <li>Guess I should have checked EncodeQuotedPrintable() as well, since it did the same thing BreakMessage() did in adding an extranneous CRLF to the end of any text it processed.  Fixed.</li>
    </ul>
  </li>
  <li>Version 1.4 - 03/12/2001
    <ul>
      <li>BreakMesage() added an extranneous CRLF to the end of any text it processed, which is now fixed.  Certainly not a big deal, but it caused text attachments to not be 100% identical to the original.</li>
    </ul>
  </li>
  <li>Version 1.3 - 03/11/2001
    <ul>
      <li>Added a new class, CSmtpMimePart, to which the CSmtpAttachment and CSmtpMessageBody classes now inherit.  This was done for future expansion.  CSmtpMimePart has a new ContentId string value for optionally assigning a unique content ID value to body parts and attachments.  This was done to support the multipart/related enhancement.</li>
      <li>Added a MessageId member to the CSmtpMessage class to allow users to optionally specify a message ID.</li>
      <li>Added a boolean Inline member variable to CSmtpAttachment to allow users to specify that the content-disposition is Inline rather than Attachment.</li>
      <li>Support for multipart/related messages, which can be used for sending html messages with embedded images.</li>
      <li>Modifed CSmtpMessage, adding a new MimeType member variable so the user can specify a certain type of MIME format to use when coding the message.</li>
      <li>Fixed a bug where multipart/alternative messages with multiple message bodies were not properly processed when attachments were also included in the message.</li>
      <li>Some small optimizations during the CSmtpMessage::Parse routine</li>
   </ul>
  </li>
  <li>Version 1.2 - 03/10/2001
    <ul>
      <li>Vastly improved the time it takes to break a message, which was dog slow with large attachments.  My bad.</li>
      <li>Added another overridable, SmtpProgress() which is called during the CSmtp::SendCmd() function when there is a large quantity of data being sent over the wire.</li>
      <li>Added CMD_BLOCK_SIZE to support the above new feature</li>
      <li>Added support for UNICODE builds</li>
      <li>Added the CSmtpAttachment class for better control and expandability for attachments.</li>
      <li>Added alternative implementations for CSmtp::SendMessage which make it easier to send simple messages via a single function call.</li>
      <li>Added a constructor to CSmtpAddress for assigning default values during initialization.</li>
      <li>Added a #pragma comment(lib,&quot;wsock32.lib&quot;) to the smtp.h so you don't have to modify your project's linker options
      </li>
    </ul>
  </li>
</ul>

<h3>Downloads</h3>
<a href="smtpSimpson.zip">Download the source code - 16 Kb</a>

<h3>History</h3>
Date Posted: March 13, 2001<BR>
Last Updated: April 10, 2001

<!--comments-->
<h3>Comments:</h3><ul>
<!--startlist-->
<li><a href="/mfc/comments/34810.shtml">Just a small hint...</a> - Kirill A. Bykov (2002/03/19)

<li><a href="/mfc/comments/34647.shtml">Crash with empty attachment file</a> - Eckhard Schwabe (2002/03/15)


<li><a href="/mfc/comments/33030.shtml">Thanks! Anyone else tried sending large html docs?</a> - John (2002/02/08)

<li><a href="/mfc/comments/32438.shtml">Great! But CC addresses not showing up correctly...</a> - Cedarmeister (2002/01/27)

<li><a href="/mfc/comments/27867.shtml">Customizing the reply to address</a> - Arthur (2001/10/17)

<li><a href="/mfc/comments/25464.shtml">Fix for &quot;Shattered Windows&quot;</a> - Mark Eby (2001/08/14)

<li><a href="/mfc/comments/25461.shtml">This hangs in &quot;Shattered Windows&quot;</a> - mark Eby (2001/08/14)

<li><a href="/mfc/comments/25420.shtml">BUG:_T2A</a> - Lee (2001/08/13)

<li><a href="/mfc/comments/25042.shtml">win98/Outlook Express Hangs</a> - dgraham (2001/08/01)

<li><a href="/mfc/comments/24184.shtml">Very Good! Thank you</a> - Lee (2001/07/06)

<li><a href="/mfc/comments/24123.shtml">Error while sending commands</a> - Yura (2001/07/04)

<li><a href="/mfc/comments/24079.shtml">Very good! But I've fixed CC,BCC and FD_SET bugs ~</a> - Jake Lee (2001/07/03)

<li><a href="/mfc/comments/23929.shtml">CC:, BCC: recipients added as TO: recipients</a> - Clark Laughlin (2001/06/27)

<li><a href="/mfc/comments/23847.shtml">How to send message body as html?</a> - Polaris (2001/06/25)

<li><a href="/mfc/comments/23831.shtml">ARTICLE UPDATED</a> - Brad Jones (2001/06/25)

<li><a href="/mfc/comments/23546.shtml">c email client</a> - Bria Keating (2001/06/08)

<li><a href="/mfc/comments/23237.shtml">Is there any ATL POP3 Classe available</a> - Pierre (2001/05/30)

<li><a href="/mfc/comments/22986.shtml">error</a> - zjjajy (2001/05/22)

<li><a href="/mfc/comments/22843.shtml">Very Good Class but trouble with Date</a> - Noa,Karsten (2001/05/17)

<li><a href="/mfc/comments/22705.shtml">Very good, I built a thread safe e-mail server on this!</a> - POSITRON (2001/05/11)

<li><a href="/mfc/comments/22660.shtml">Help me.. I need quoted-printed encode/decode..</a> - homunlee (2001/05/09)

<li><a href="/mfc/comments/22142.shtml">performance</a> - XiangQianyong (2001/04/22)

<li><a href="/mfc/comments/21733.shtml">Pre-Loading Account Details...</a> - Denis Birnie (2001/04/10)

</ul>

<P>
<strong><a href="/cgi-bin/addpage/addpage.cgi?cfg=addcomment&action=Comment">
Add Comment</a></strong>
<P>

</td>

      <!--BLJAds - Added right side tower ad -->
<TD VALIGN="TOP">
<A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27327/125x800/House_Enterprise_Storage_3b/esf-125x600.gif/31386135353132373363616432346330" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_Enterprise_Storage_3b/esf-125x600.gif"  ALT="Enterprise Storage Forum.com"  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27327/125x800/House_Enterprise_Storage_3b/esf-125x600.gif/31386135353132373363616432346330?_RM_EMPTY_" Width="1" Height="1" Border="0">

<p>

<!-- Commerce bar -->
<table border="0" cellpadding="3" width="140">

<tr bgcolor="black"><td>
<font face="Arial" color="white" size="1" >
<b><center>internet.commerce</center></b></font>
</td></tr>
<tr bgcolor="lightgrey"><td>
<font face="Arial" size="1" >
<a href="http://www.internet.com/partners/">Be a Commerce Partner</A><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16407/cp1/Top_Hosts_10c/tophosts.html/31386135353132373363616432346330">Find a Web Host</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16407/cp1/Top_Hosts_10c/tophosts.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<A href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5486/cp2/Domain_Bank_11c/RegisterDomains.html/31386135353132373363616432346330">Register Domains</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5486/cp2/Domain_Bank_11c/RegisterDomains.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27334/cp3/MonitorsDirect_2d/MonitorsforUSIT.html/31386135353132373363616432346330">Monitors for U.S. IT</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27334/cp3/MonitorsDirect_2d/MonitorsforUSIT.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16413/cp4/Atlantic_net_2d/DedicatedHosting.html/31386135353132373363616432346330">Dedicated Hosting</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16413/cp4/Atlantic_net_2d/DedicatedHosting.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5493/cp5/Imici_2c/SecureBusinessIM.html/31386135353132373363616432346330">Secure Business IM</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5493/cp5/Imici_2c/SecureBusinessIM.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27340/cp6/Tradepub.com_9c/tech.html/31386135353132373363616432346330">Tech Magazines-Free</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27340/cp6/Tradepub.com_9c/tech.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16420/cp7/Fatbrain_5d/BuyBooksHere.html/31386135353132373363616432346330">Buy Books Here</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16420/cp7/Fatbrain_5d/BuyBooksHere.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5500/cp8/NewMediary_10c/ITSolutionsCenter.html/31386135353132373363616432346330">IT Solutions Center</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/5500/cp8/NewMediary_10c/ITSolutionsCenter.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27347/cp9/Broad_Band_Buyer_2d/ShopforBandwidth.html/31386135353132373363616432346330">Shop for Bandwidth</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/27347/cp9/Broad_Band_Buyer_2d/ShopforBandwidth.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16427/cp10/ImpactBuilderPro_com_2d/buildflashonline.html/31386135353132373363616432346330">Build Flash Online</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/16427/cp10/ImpactBuilderPro_com_2d/buildflashonline.html/31386135353132373363616432346330?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>

</font>
</td></tr>
</table>
<br>


</TD>

</tr>
</table>
<!-- begin footer information -->
<br>
<CENTER>
<A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/12313/468x60-2/House_VoiceXML_For_BusMgrs_1c/voicexmlbus_750.gif/31386135353132373363616432346330" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_VoiceXML_For_BusMgrs_1c/voicexmlbus_750.gif"  ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/internet/smtpSimpson.html/12313/468x60-2/House_VoiceXML_For_BusMgrs_1c/voicexmlbus_750.gif/31386135353132373363616432346330?_RM_EMPTY_" Width="1" Height="1" Border="0">
<br>
<FONT SIZE="-1">EarthWeb is a service of INT Media Group, Incorporated.<br>
Copyright 2002 INT Media Group, Incorporated. All Rights Reserved.<BR>
<A HREF="http://www.internet.com/help/feedback.html">Feedback</A>, &nbsp;
<A HREF="http://www.itmarketer.com">Advertising Info</A>, &nbsp;
<A HREF="http://www.internet.com/corporate/legal.html">Legal Notices</A>,&nbsp;
<A HREF="http://www.internet.com/corporate/reprints.html#Licensing">Licensing</A>, 
<A HREF="http://www.internet.com/corporate/reprints.html#Reprints">Reprints</A>, &amp; 
<A HREF="http://www.internet.com/corporate/reprints.html#Permissions">Permissions</A>, &nbsp;
<A HREF="http://www.internet.com/corporate/privacy/privacypolicy.html">Privacy Policy</A>.
<BR>
<A HREF="http://www.internet.com"><IMG SRC="/images/internetcom.gif"
ALT="http://www.internet.com/" WIDTH="161" HEIGHT="18"
BORDER="0"></A></FONT>
</CENTER>

</BODY>
</HTML>





